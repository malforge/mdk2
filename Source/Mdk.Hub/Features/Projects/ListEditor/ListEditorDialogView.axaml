<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:list="clr-namespace:Mdk.Hub.Features.Projects.ListEditor"
             mc:Ignorable="d" d:DesignWidth="600" d:DesignHeight="400"
             x:Class="Mdk.Hub.Features.Projects.ListEditor.ListEditorDialogView"
             x:DataType="list:ListEditorDialogViewModel">

    <Grid ColumnDefinitions="10*, 80*, 10*">
        <Border Classes="dialog-container"
                Grid.Column="1"
                HorizontalAlignment="Center"
                VerticalAlignment="Center"
                Width="600"
                Height="400">
            <Grid RowDefinitions="Auto,Auto,*,Auto,Auto">
                <!-- Title -->
                <TextBlock Text="{Binding Message.Title}"
                           Classes="h1"
                           Grid.Row="0"
                           Margin="0,0,0,8" />

                <!-- Description -->
                <TextBlock Text="{Binding Message.Description}"
                           Classes="body"
                           Grid.Row="1"
                           TextWrapping="Wrap"
                           Margin="0,0,0,16" />

                <!-- Item list -->
                <ScrollViewer Grid.Row="2"
                              VerticalScrollBarVisibility="Auto">
                    <ItemsControl ItemsSource="{Binding Items}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate x:DataType="list:ListEntryViewModel">
                                <Grid ColumnDefinitions="*,Auto"
                                      Margin="0,0,0,8">
                                    <!-- Value input -->
                                    <TextBox Grid.Column="0"
                                             Text="{Binding Value}" 
                                             Watermark="{Binding Watermark}" />

                                    <!-- Delete button (only visible for non-empty rows) -->
                                    <Button Grid.Column="1"
                                            Command="{Binding DeleteCommand}"
                                            CommandParameter="{Binding}"
                                            Content="Ã—"
                                            Width="32"
                                            Height="32"
                                            FontSize="20"
                                            Padding="0"
                                            Margin="8,0,0,0"
                                            HorizontalContentAlignment="Center"
                                            VerticalContentAlignment="Center"
                                            VerticalAlignment="Center"
                                            IsVisible="{Binding !IsEmpty}"
                                            ToolTip.Tip="Delete this item" />
                                </Grid>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>

                <!-- Validation message -->
                <Grid Grid.Row="3"
                      MinHeight="40"
                      Margin="0,8,0,0">
                    <TextBlock Text="{Binding ValidationError}"
                               Foreground="{DynamicResource ForegroundDangerBrush}"
                               Classes="medium"
                               TextWrapping="Wrap"
                               VerticalAlignment="Top"
                               IsVisible="{Binding ValidationError, Converter={x:Static StringConverters.IsNotNullOrEmpty}}" />
                </Grid>

                <!-- Buttons -->
                <StackPanel Grid.Row="4"
                            Orientation="Horizontal"
                            HorizontalAlignment="Right"
                            Spacing="8"
                            Margin="0,8,0,0">
                    <Button Content="Save"
                            Command="{Binding SaveCommand}"
                            IsDefault="True"
                            MinWidth="100" />
                    <Button Content="Cancel"
                            Command="{Binding CancelCommand}"
                            IsCancel="True"
                            MinWidth="100" />
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</UserControl>
